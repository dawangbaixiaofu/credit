## 概率校验
当使用分类模型进行预测的时候，不仅仅是想预测类别标签是什么同时还想预测每个标签的概率是多少。预测概率的大小可以让我们知道模型预测的可靠程度（label=1）。
对模型预测概率进行校验可以让校验后的模型输出概率和真实的置信水平更加的接近。


这里‘真实的置信水平’ $y_i$ 定义：
- 对模型预测分 $p_i$ 进行分桶
- 每个桶内样本真实标签为1的占比 $$ratio = \frac{label=1的样本数量}{桶内的总样本数量}$$


符号标记：
- $f_i$ 样本的校准后的预测概率
- $y_i$ 样本的真实置信水平


为了实现对模型概率的校准，可以使用一个‘合适的回归模型’去拟合 $(y_i, f_i)$ ，学到的校准模型即校准器。
校准器可以是简单的逻辑回归模型，更推荐的是保序回归模型。



## 保序回归模型
保序回归规划问题描述如下：

$$
\\begin{aligned}
target:& min \sum_{i=1}^{n} w_i * (y_i - f_i)^2 \\
subject \quad to:& f_i \leq f_j, when \quad x_i \leq x_j \\
x 是特征值且维度是一维
\\end{aligned}
$$

解一般是分段单调函数，而逻辑回归的解是一条直线，保序回归一般比逻辑回归更适合用于概率校验。
